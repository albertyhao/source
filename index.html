<!DOCTYPE html>
<html>
	<head>
		<title>SPN</title>
		<style>
			body {
				background-image: url('https://nerdist.com/wp-content/uploads/2014/10/Sam-and-Dean-Winchester_featured.jpg');
				background-size: cover;
			}

			label {
				color: white;
			}

			href {
				color: white;
			}
		</style>
	</head>
	<body>
		<div>
			<label>Username?</label>
			<input type='text' name='name'>
		<div>
		<div>
			<label>Email</label>
			<input type='text' name='username'>
		<div>
		<div>
			<label>Password</label>
			<input type='text' name='password'>
		</div>
		<div>
			<label>Verify Password</label>
			<input type='password' name='verifyPassword'>
		</div>
		<div>
			<label>Favorite Supernatural character?</label>
			<input type='text' name='favoritespncharacter'>
		<div>
			<label>Least favorite Supernatural character?</label>
			<input type='text' name='leastfavoritespncharacter'>
		</div>
		<div>
			<label>Favorite Supernatural villian? (maybe the same as one of the above)</label>
			<input type='text' name='favoratespnvillian'>
		</div>

		<button>SUBMIT</button>

		<div>
			<a href="/">Home<a>
		</div>

		<div>
			<a href="/login">Login<a>
		</div>

		<div>
			<a href="/game">Game Board<a>
		</div>



		</div>

		<script>

		var $button= document.querySelector('button')

		function verifyPassword() {

		var $passwords = document.querySelectorAll('input[type="password"]');
		var $isSamePassword = $passwords[0].value === $passwords[1].value;
		if(!isSamePassword) {
			alert("Please enter the same password!")
		}
		return isSamePassword;

		}

		function storeData () {
			var data = {};
			var $inputs= document.querySelectorAll('input')

			for(var i = 0; i < $inputs.length; i++) {
				var $input = $inputs[i];
				data[$input.name] = $input.value
			}
			sendData(data);
		}

		function sendData(data) {
			if(!verifyPassword()) {
				// Alert the user to any errors from the server
				function readyStateChange() {
					if(req.readyState !== 4) return;
					if(req.status !== 200) return;

					data = JSON.parse(req.responseText);
					if(data.error) {
					alert(data.error);
				}
			}
req.onreadystatechange = readyStateChange;
			return;
		}
			// Creating a new request to the server that contains the data
		var req = new XMLHttpRequest();

			// Opening up a connection with the server to 'POST' data
			req.open('POST', '/form', true);

			// Explain to the server that we are sending the data in json format
			req.setRequestHeader('content-type', 'application/json')

			// Sending the data in JSON format
			req.send(JSON.stringify(data));
		}

	$button.addEventListener('click', storeData)

	</script>

</body>
</html>
